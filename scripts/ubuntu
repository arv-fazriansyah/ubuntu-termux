#!/system/bin/sh

cmd=$1
export bin=/system/bin
export PATH=/usr/bin:/usr/sbin:/bin:/usr/local/bin:/usr/local/sbin:$PATH
export TERM=linux
export HOME=/root
export USER=root
export LOGNAME=root
unset LD_PRELOAD
unset PROMPT_COMMAND
localbuild="/data/local/tmp/ubuntu"
#localbuild="/data/data/com.termux/files/home/ubuntu"

uninstall() {
  echo -e "\e[30;48;5;82m STATUS \e[40;38;5;82m MENGHAPUS UBUNTU... \e[0m"

  # Hapus direktori instalasi Ubuntu jika ada
  if [ -d "$localbuild" ]; then
    sudo rm -rf "$localbuild"
  fi

  # Hapus pintasan ubuntu dari $PREFIX/bin
  rm "$PREFIX/bin/ubuntu" 2> /dev/null

  if [ -d "$localbuild" ] || [ -f "$PREFIX/bin/ubuntu" ]; then
    echo -e "\e[30;48;5;82m STATUS \e[40;38;5;82m GAGAL MENGHAPUS! \e[0m"
    exit 1
  else
    echo -e "\e[30;48;5;82m STATUS \e[40;38;5;82m PENGHAPUSAN SELESAI! \e[0m"
    exit 0
  fi
}

# Menggabungkan fungsi-fungsi serupa
if [ "$EUID" -ne 0 ]; then
  case $cmd in
    "-u" | "--uninstall")
      uninstall
      ;;
    "")
      # kosong
      ;;
    *)
      echo -e "\e[30;48;5;82m STATUS \e[40;38;5;82m PERINTAH TIDAK VALID! \e[0m"
      exit 1
      ;;
  esac

  clear
  chroot "$localbuild" /bin/login -f root
else
  case $cmd in
    "-u" | "--uninstall")
      uninstall
      ;;
    "")
      # kosong
      ;;
    *)
      echo -e "\e[30;48;5;82m STATUS \e[40;38;5;82m PERINTAH TIDAK VALID! \e[0m"
      exit 1
      ;;
  esac

  clear
  sudo chroot "$localbuild" /bin/login -f root
fi
